import requests
from lxml import etree
from dbs.mongodbclient import MongodbClient
# html = requests.get("http://91xinshang.com/bag/a0/?isduo=no##").text
# tree = etree.HTML(html)
# ""
# # brand = tree.xpath('//li[@class= "isok"]//a/text()')
# brand = tree.xpath('//div[@class= "cate_wrap currC Multiselect"]//ul//li//a/text()')
#
# i = 1
# data = {}
# print(len(brand))
# for item in brand:
#     data[item] = i
#     i +=1
# print(data)

# brand = {'Designinverso': 207, 'Alice + Olivia': 96, 'Roberto Cavalli': 408, 'Dries van noten': 183, 'JohnVarvatos': 508, 'Iridescence New York': 26, 'Bai': 111, 'Breitling': 133, 'Manolo Blahnik': 326, 'Versace': 477, 'Vivienne Westwood': 483, 'Loeffler Randall': 319, 'Chloé': 161, 'GUCCI': 244, 'FRED PERRY': 225, 'J·ESTINA': 30, 'Sonia Rykiel': 436, 'Moynat': 355, 'Fear of God': 218, 'Allen edmonds': 76, 'ARNOLD&SON': 104, 'CHARLES KEITH': 492, 'Rene Caovilla': 400, 'MARIE MULLIN': 348, 'A.P.C.': 98, 'ONLY': 47, 'DeWitt': 186, 'Ann Taylor': 109, 'Repetto': 401, 'Dazzle': 180, 'SLY': 56, 'Gentle Monster': 233, 'Valentino': 473, 'Carshoe': 12, 'SEIKO': 276, 'DSQUARED2': 178, 'Desigual': 184, 'Anne Klein': 93, 'Sobdeall': 423, 'Lee': 306, 'just cavalli': 283, 'Alfred Dunhill': 68, 'Hermès': 254, 'JeanRichard': 281, 'Ardene': 101, 'Abercrombie & Fitch': 71, 'DANIELROTH': 192, 'Les Nereides': 34, 'GEOX': 234, 'ISSEY MIYAKE': 263, 'Clarks': 170, 'Movado': 354, 'Canali': 146, 'Coppertone': 393, 'marchesa notte': 327, 'Jaeger-LeCoultre': 272, 'Alfred dunner': 88, 'Tiger of Sweden': 61, 'Oris': 372, 'GIANNL VERSACE': 236, 'MMAGPY': 349, 'St. John': 429, 'GEDEBE': 232, 'Sarcar': 419, 'Anne Fontaine': 92, 'TAG Heuer': 447, 'MISSSIXTY': 39, 'CASIO': 287, 'Three Floor': 457, 'Richard Mille': 402, 'LONGINES': 317, 'J.W. Anderson': 28, 'Raymond Weil': 398, 'Glashutte Original': 229, 'Gucci Kids': 245, 'Christian Louboutin': 169, 'MSGM': 356, 'Y3': 500, 'Franck Muller': 217, 'PANDORA': 375, 'Fox': 221, 'lapalette': 305, 'jinzhiyin': 277, 'China Gold': 158, 'izzue': 265, 'Under Armour': 467, 'Alexandre Birman': 87, 'Roger Vivier': 409, 'Future Glory': 21, 'VANS': 206, 'Tommy Hilfiger': 453, 'CHARLOTTE OLYMPIA': 172, 'FILA': 211, 'FLAVIO CASTELLANI': 216, 'Ferrero Ross': 212, 'STEVE MADDEN': 438, 'tapenade': 449, 'ZIOTELLO': 29, 'House of hello': 258, 'Moussy': 44, '心上': 496, 'Club Monaco': 171, 'Grace Deng': 231, 'Bench': 124, 'Laomiao': 303, 'Neil Barrett': 363, 'Alex and Ani': 86, 'Saucony': 442, 'Golden Goose Deluxe': 25, 'Parker': 378, 'Vita fede': 64, 'A.Lange&Söhne': 84, 'Chow Sang Sang': 163, 'RIMOWA': 404, 'Brunello Cucinelli': 8, 'TESIRO': 463, 'Tom Ford': 452, 'Diesel': 188, 'Steve J & Yoni P': 430, 'visvim': 490, 'Cuihua Gold Shop': 160, 'stuart weitzman': 439, 'LOEWE': 315, 'VICINI': 480, 'FARINA.Z': 228, 'Carven': 149, 'Lukfook Jewellery': 321, 'Badgley Mischka': 129, 'Melissa': 36, 'IWC': 264, 'Emilio Pucci': 202, 'Brahmin': 135, 'Champion': 13, 'self-portrait': 421, 'SEA-GULL': 248, 'COACH': 173, 'MLB': 40, 'Ulysse Nardin': 470, 'Concord': 175, 'Fauré Le Page': 226, 'Noah': 366, 'Karen Walker': 298, 'Rolex': 411, 'R13': 52, 'nicholas kirkwood': 364, 'Liemoch': 309, 'HAMILTON': 249, 'Timberland': 461, 'GCDS': 23, 'Cedric Charlier': 150, 'HUGO BOSS': 260, 'Simon Miller': 55, 'PB 0110': 49, 'Devil Beauty': 185, 'JAZZSTAR': 268, 'Breguet': 132, 'Cult Gaia': 15, 'Rag & Bone': 395, 'Marni': 329, 'MO&Co': 41, 'Victoria Beckham': 479, 'MANSUR GAVRIEL': 42, 'Picard': 50, 'DRKSHDW': 194, 'TIANWANG': 59, 'PALACE': 374, 'ARMANI': 102, 'Viktor&Rolf': 487, 'Zac Posen': 513, 'OFF-WHITE': 368, 'Ernest Borel': 504, 'ESCADA': 79, 'Van Cleef Arpels': 476, 'Massimo Dutti': 334, 'Callisto': 144, 'Dior Homme': 187, 'Cole Haan': 174, 'APM MONACO': 99, 'AMO&JOY': 91, 'Red Valentino': 415, 'Maje': 324, 'Thom Browne': 60, 'BrooksBrothers Women': 121, 'REEBOK': 412, 'Sandro': 417, 'Christopher Bu': 138, 'Stella Luna': 431, 'Chow Tai Fook': 176, 'Furla': 227, 'Fear Of God': 210, 'MaxMara': 332, 'G-cut': 22, 'PATEK PHILIPPE': 380, 'ANYA HINDMARCH': 95, 'See by Chloe': 420, 'DKNY': 190, 'Jeffrey Campbell': 270, 'COCCINELLE': 293, 'Aeropostale': 108, 'Ralph Lauren': 396, 'N°21': 46, 'Longchamp': 316, 'Love Moschino': 318, 'Zara': 510, 'BCBG Max Azria': 122, 'Giorgio Armani': 230, 'Burberry': 139, 'J.Crew': 271, 'ZENITH': 512, 'meli melo': 54, 'Moncler': 351, 'Marc Jacobs': 328, 'ochirly': 48, 'Montblanc': 352, 'Theowner': 414, 'Ewing': 505, 'WhateverEyewear': 425, 'Bebe': 10, 'Fangiwen bianco': 208, "L'INOUI": 310, '其它': 509, 'Agent Provocateur': 73, 'HelmutLang': 255, 'Sergio Rossi': 422, 'CHJ Jewellery': 159, 'Pierre Kunz': 385, 'Michael kors': 346, 'DIETRICH': 193, 'Aldo': 85, 'Alexander Wang': 110, 'moiselle': 358, 'Bovet': 131, 'Adidas': 69, 'PARMIGIANI': 379, 'Keer': 288, 'JACOB & CO': 266, 'Lukfook': 313, 'BLACK HALO': 125, 'Lids': 307, 'Calvin Klein': 168, 'FABRIZIO LENZI': 19, 'Kate Spade': 295, 'Mido': 341, 'CORUM': 143, 'Saint Laurent Paris': 432, 'Girard-Perregaux': 241, 'Hogan': 257, 'Samsonite': 499, 'Certina': 498, 'Thakoon': 454, 'Theory': 456, 'Philipp Plein': 387, 'Gianvito Rossi': 242, 'STAUD': 428, 'Kurt Geiger': 297, 'Delvaux': 182, 'GIVENCHY': 237, 'J Brand': 269, 'Tory Burch': 450, 'Neighborhood': 362, 'KENZO': 292, 'Armani Exchange': 103, 'New Balance': 494, 'Armani Jeans': 81, 'Maison Margiela': 350, 'Gerald Genta': 235, 'hanfuhui': 250, 'HUBLOT': 259, 'TOUS': 448, 'Mansur Gavriel': 340, 'M2MALLETIER': 37, 'Moschino': 353, 'Maxstudio': 335, 'Milly': 342, 'American Eagle': 70, 'Chaumet': 155, 'VERSUS': 478, 'F.P.JOURNE': 222, 'common projects': 239, 'Blancpain': 128, 'Phillip Lim': 383, 'Batar Jewellery': 119, "Arc'teryx": 100, 'PIAGET': 384, 'Vinoce': 489, 'Proenza Schouler': 51, 'T400': 58, 'Byer California': 142, 'Ximena Kavalekas': 66, 'Folli Follie': 219, 'ZARA': 416, 'Cartier': 148, 'TOD’S': 462, 'Celestine': 152, '1881': 4, 'BALLY': 114, 'Nico Giani': 45, 'Laofengxiang': 302, 'Vince Camuto': 482, 'Giuseppe Zanotti': 247, 'Juvenia': 284, 'Mingr': 343, 'Marisfrolg': 330, "Church's": 14, 'ROAMER': 407, 'police': 275, 'BALMAIN': 115, 'stussy': 440, 'J Koo': 279, 'jorya': 280, 'JIMANNO': 273, 'Stella McCartney': 433, 'VERA WANG': 486, 'Rick Owens': 403, 'CHIARA FERRAGNI': 157, 'little joys': 312, 'Bananas': 117, 'Undefeated': 471, 'Wandler': 65, 'Free People': 18, 'Z Zegna': 516, 'napapijri': 360, 'PRADA': 388, 'Marella': 43, 'H.Moser&Cie': 256, 'Daniel Wellington': 16, 'Panerai': 376, 'Polo Ralph Lauren': 390, 'Amiri': 90, 'Mulberry': 357, 'Ports 1961': 373, 'Pretty Ballerinas': 382, 'Mikimoto': 507, 'OMEGA': 371, 'La pargay': 304, 'Superdry': 443, 'Gianfranco lotti': 27, 'MAX&Co.': 333, 'Chrome Hearts': 165, 'Elie Saab': 75, 'Jenni Kayne': 278, 'Guess': 246, 'ONE MORE': 370, "A'GACI": 72, 'Dupont': 195, 'Aape': 7, 'Goyard': 240, 'Ermanno Scervino': 204, 'MCM': 336, 'Tabitha Simmons': 446, 'FENDI': 213, 'ECCO': 199, 'Zatchels': 511, 'FOSSIL': 220, 'Brooks Brothers': 136, 'MESSIKA': 339, 'Rabeanco': 53, 'Colour Eighteen': 151, 'Oliver Peoples': 369, 'Ted Baker': 451, 'Narciso Rodriguez': 361, 'Alexander McQueen': 89, 'CRD': 289, 'Bossini': 130, 'CHANEL': 156, 'DOLCE&GABBANA': 177, 'Dior': 189, 'Ferragamo': 215, 'Sport max': 435, 'Diamond Dazzle': 181, 'SWAROVSKI': 445, 'Air Jordan': 392, 'Sze': 427, 'Five Plus': 20, 'madness': 214, 'GM': 24, 'Sophie hulme': 57, 'Nomos': 367, 'Carl F.Bucherer': 147, 'parallele': 377, 'AIR Group Captain': 294, 'Henrl bendel': 253, 'Tiffany & Co.': 460, 'Marc by Marc Jacobs': 345, 'Sam Edelman': 426, 'The North Face': 455, 'Chow Taiseng': 164, 'Splendid': 434, '3×1jeans': 2, 'Ebel': 198, 'Baume & Mercier': 120, 'BVLGARI': 141, 'UGG': 468, 'Ground Zero': 32, 'Irregular choice': 137, 'Emile Chouriet': 201, 'Aquazzara': 83, 'simone rocha': 493, 'extra fine merinwool': 200, 'Paul Smith': 381, 'Ray-Ban': 397, 'VERO MODA': 63, 'Versace Jeans': 484, 'Titoni': 337, 'ANTEPRIMA': 94, 'Etro': 80, 'John RiCnmOnd': 311, '7 for All Mankind': 1, 'Maurice Lacroix': 331, 'Banana Republic': 116, 'MARCELO BURLON': 38, 'Karl Lagerfeld': 285, 'Alain mikli': 5, 'Celine': 153, 'Calvin Klein jeans': 11, "Levi's": 314, 'Bass': 118, 'L.k.bennett': 9, 'Manu Atelier': 325, 'LACOSTE': 299, 'Emporio Armani': 197, 'Roger Dubuis': 410, 'preventi': 389, 'ISABEL MARANT': 261, 'Jaquet Droz': 267, 'Jimmy Choo': 274, 'I Do': 491, 'Rene Boivin': 399, 'Stefano Ricci': 437, 'Onitsuka Tiger': 6, 'Hefang': 252, 'NIPMAR': 308, 'Armand Nicolet': 77, '钻石': 515, 'NIKE': 359, 'Bell & Ross': 123, 'cachecache': 514, 'Topshop': 62, '3DG Jewellery': 3, 'Diane von Furstenber': 196, 'Hazzys': 251, 'BALL': 113, 'G-Star RAW': 243, 'Nina Ricci': 365, 'Tumi': 466, 'Louis Vuitton': 322, 'Rebecca Minkoff': 406, 'Balenciaga': 112, 'ASH Shoes': 105, 'Chopard': 162, 'EBERHARD&CO': 503, 'GALLIANO': 145, 'ICEBERG': 127, 'Vince': 481, 'asics': 502, 'sevenfriday': 495, 'ALYAIO': 78, 'CAT': 286, 'WHAT FOR': 488, 'LANCEL': 300, 'Frederique Constant': 223, 'Romain Jerome': 405, 'Dr.martens': 17, 'Supreme': 444, 'LeSportsac': 320, 'Vacheron Constantin': 475, 'Marie Elie': 323, 'Boy London': 33, 'IRIS & INK': 262, 'Little Liffner': 31, 'Frame Denim': 209, 'PUMA': 126, 'Canada Goose': 154, 'Bottega Veneta': 140, 'Acne Studios': 67, 'Audemars Piguet': 97, 'Tibi': 459, 'Tudor': 465, 'Trussardi': 167, 'LANVIN': 301, 'Bremont': 134, 'TSL': 464, 'Union': 472, 'Waltham': 485, 'Valextra': 474, 'Juicy Couture': 282, 'UGG Australia': 469, 'Cristinaeffe': 290, 'PINKO': 386, 'CITIZEN': 497, 'alexis bittar': 501, 'CHRONOSWISS': 166, 'mr&mrs': 224, 'SOPHIA WEBSTER': 441, 'YOHJI YAMAMOTO': 424, 'AGATHA': 74, 'Adidas Originals': 418, 'Memorigin': 338, 'MARKUS Lupfer': 347, 'epos': 203, 'Abercrombie Kids': 82, 'Converse': 296, 'TISSOT': 458, 'ASSC': 107, 'Aerosoles': 106, 'DKNY Sport': 191, 'Russell & Bromley': 413, 'Yves Saint Laurent': 506, 'kendra scott': 291, 'Ermenegildo Zegna': 205, 'darryring': 179, 'Miu Miu': 344, 'push button': 391, 'RADO': 394, 'GRAHAM': 238}
sort = {'手包/手拿包': 9, '手提包': 1, 'Ipad套/手机套': 6, '双肩包': 2, '单肩包': 3, '化妆包': 5, '旅行箱/行李箱': 10, '卡套/证件套': 8, '腰包/胸包': 7, '公文包': 4, '钱包/卡包/钥匙包': 11}

momgodb = MongodbClient(
            mongodb_conf={'host': '61.147.124.76', 'port': 27017, 'db_name': 'xs_spider', 'table_name': 'xs_datas'})

data = momgodb.collection.find({}, {"uuid":1 ,"type":1,"_id": 0})
for item in data:
    print("第一个数据",item)
    value = item.get("type")
    try:
        for sub in str(value).split("/"):
            for key,num in sort.items():
                if sub in key:
                    momgodb.collection.update({"uuid":item.get("uuid")}, {"$set": {"type_code": int(num)}})
                    break
                else:
                    pass
    except:
        print("空")
